<!DOCTYPE html>
<html>
  <head>
    <link rel="stylesheet" type="text/css" href="styles.css" />
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
    <script type="text/javascript" src="twitter_data.js"></script>
    <script type="text/javascript" src="moment.min.js"></script>
  </head>
  <body>
    <div class='button'>
      <button class='refresh'>Get Tweets</button>
      <label></label>
    </div>
    <div class='tweets'>
      <ul></ul>
    </div>
    <div class="user-sidebar">
      <ol></ol>
    </div>
    <script>
      $('button').click(function(){
        $('label')['html'](' ');
        $('label')['append']('All tweets since: ' + moment().format('h:mm:ss a'));
        var $div = $('div.tweets');
        $div['html']('');
        var allhtml = "";

        var index = streams['home']['length'] - 1;

        while(index >= 0){
          var tweet = streams['home'][index];
          console['log']('rendering a tweet:', tweet);
          var html = '<li><div class="tweetBox clickBox"><span class="userclick">' + tweet['user'] + 
            '</span>' + ' : ' + ' <div class="time">[' + moment().format('h:mm:ss a') + ']</div>  ' + tweet['message'] + '</div></li>';
          allhtml += html;
          index = index - 1;
        }

        $div['html'](allhtml);
      });



      $('body').on('click', '.userclick', function(){
        /*
        var $div2 = $('div.user-sidebar');
        $div2['html']('');
        var sidehtml = "";
        */
        $('.user-sidebar > li, h4').remove();
        
        var username = $(this)['text']()
        var date = new Date();
        $('.user-sidebar').append('<h4 class="userText">Tweets from ' + username  + ' since: ' + moment().format('h:mm:ss a') + '</h4>');
        tweetindex = streams['users'][username]['length'] - 1
        for (i = tweetindex; i >= 0; i--){
          $('.user-sidebar')['append']('<li class="tweetBox userBox">' + streams['users'][username][i]['message'] + '</li>')
        }
          
      });

    </script>
  </body>
</html>
